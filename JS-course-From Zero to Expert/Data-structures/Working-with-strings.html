<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        height: 100vh;
        display: flex;
        align-items: center;
        background: linear-gradient(to top left, #28b487, #7dd56f);
      }
      h1 {
        font-family: sans-serif;
        font-size: 50px;
        line-height: 1.3;
        width: 100%;
        padding: 30px;
        text-align: center;
        color: white;
      }
      button {
        width: 50px;
        height: 20px;
        margin: 10px;
      }
      textarea {
        width: 300px;
        height: 100px;
      }
    </style>
  </head>
  <body>
    <script>
      'use strict';
      const airline = 'TAP Air Portugal';
      const plane = 'A320';

      console.log(plane[0]);
      console.log(plane[1]);
      console.log(plane[2]);

      // 可以直接把字串寫出來，用來取值
      console.log('BJ4'[1]);

      console.log(airline.length);
      console.log('TAW Air Taiwan'.length);

      // 找到該字串的位置，會找出第一個相符的
      console.log(airline.indexOf('r'));
      // 找到該字串的位置，會找出最後一個相符的
      console.log(airline.lastIndexOf('r'));

      // 也可以直接找一個長字串
      console.log(airline.indexOf('Portugal'));

      // ===== slice =====
      // 出來的結果叫 substring() 用來擷取兩個索引位置之間的字串，索引位置從0 開始。
      // substring() 還有一個特別的地方在於，如果indexStart 比indexEnd 還大時，效果就像這兩個參數位置互換一樣。
      // 但因為 string 是原始型別，所以不會修改到原本的 airline 值
      // 所以如果想要存取結果，就需要存到新的變數裡
      console.log('========== slice ==========');
      console.log(airline.slice(4));
      console.log(airline.slice(-2));
      console.log(airline.slice(4, 7));

      // 剪掉最後一個字
      console.log(airline.slice(1, -1));
      console.log(airline);

      console.log(airline.slice(0, airline.indexOf('P') + 1));

      const checkMiddleSeat = function (seat) {
        // B and E are middle seats
        // 判斷字串的最後一個值是否是 B 或 E
        const s = seat.slice(-1);
        if (s === 'B' || s === 'E') console.log('You got the middle one!');
        else console.log('Not middle');
      };

      // 數字是行數，英文是column
      // 每當我們讓字串呼叫 Method 時，該字串就會自動被轉成物件
      // 比如呼叫 .slice( )
      checkMiddleSeat('11B');
      checkMiddleSeat('23C');
      checkMiddleSeat('3E');

      console.log('========== part2 ==========');
      console.log(airline.toLowerCase());
      console.log('Sam'.toUpperCase());

      // Fix capitalization in name
      const passenger = 'jOnAS';
      const passengerLower = passenger.toLowerCase();
      const passengerCorrect =
        passengerLower[0].toUpperCase() + passengerLower.slice(1);
      console.log(passengerCorrect);

      // Comparing email
      const email = 'hello@jonas.io';
      const loginEmail = ' Hello@Jonas.Io \n';

      // 1.先全部轉成小寫
      const lowerEmail = loginEmail.toLowerCase();

      // 2.刪除掉空格
      const trimmedEmail = lowerEmail.trim();
      console.log(trimmedEmail);

      // 整合成一個步驟
      const normalizedEmail = loginEmail.toLowerCase().trim();
      console.log(normalizedEmail);

      const checkCorrectEmail = function () {
        return email === normalizedEmail ? true : false;
      };
      console.log(checkCorrectEmail());

      // replacing
      // replace 方法也會產出一個新的字串，而不是修改原本的
      // 只會修改第一個
      const priceTW = '120,000NT';
      const priceUS = priceTW.replace('NT', '$').replace(',', '.');
      console.log(priceUS);

      const announcement =
        'All passengers come to boarding door 23. Boarding door 23.';

      console.log(announcement.replace('door', 'gate'));
      console.log(announcement.replaceAll('door', 'gate'));

      // 也可以用 正則表示式的方式來做
      console.log(announcement.replace(/door/g, 'gate'));

      // return Booleans
      // 用來看是否有包含該字串
      const planeName = 'Airbus A320neo';
      console.log(planeName.includes('A320'));
      console.log(planeName.includes('Boeing'));
      console.log(planeName.startsWith('A320'));
      console.log(planeName.startsWith('Air'));

      // check whether the current plane is part of the new airbus family
      if (planeName.startsWith('Airbus') && planeName.endsWith('neo')) {
        console.log('part of the new airbus family');
      }

      // Practice exercise
      // 當再處理 input 時，要在一開始就先把所有的 input 內容轉成小寫，這樣才不用大小寫都檢查
      const checkBaggage = function (items) {
        const baggage = items.toLowerCase();
        if (baggage.includes('knife') || baggage.includes('gun')) {
          console.log('You are not allowed on board');
        } else {
          console.log('Welcome!!');
        }
      };

      checkBaggage('I have a laptop, some Food, and a pocket Knife');
      checkBaggage('Socks and camera');
      checkBaggage('Got some snacks and a gun for protection');

      // split 用來分割字串，也會產生出新的陣列
      // console.log('a+very+nice+string'.split('+'));

      const [firstName, lastName] = 'Sam Huang'.split(' ');

      // join 相反的 split
      const newName = ['Mr.', firstName, lastName.toUpperCase()].join(' ');
      // console.log(newName);

      const passengerName = 'jessica ann smith davis';
      const nameCap = function (name) {
        const names = name.split(' ');
        const namesUpper = [];

        // return names;
        for (const n of names) {
          // 方法一
          // namesUpper.push(n[0].toUpperCase() + n.slice(1));

          // 方法二
          namesUpper.push(n.replace(n[0], n[0].toUpperCase()));
        }

        console.log(namesUpper.join(' '));
      };

      nameCap(passengerName);
      nameCap('sam huang');

      // add a number of characters to the string
      // 第一個參數填字串的長度，第二個填補齊的字
      const message = 'Go to gate 23!';
      console.log(message.padStart(25, '9'));
      console.log('Sam'.padStart(10, '78'));

      // padEnd
      console.log(message.padStart(20, 'f').padEnd(25, 'b'));

      const maskCreditCard = function (number) {
        const maskedNumber = number + '';
        console.log(maskedNumber);
        const fourNumber = maskedNumber.slice(-4);
        return fourNumber.padStart(25, '*');
      };

      console.log(maskCreditCard(43367840309855736));
      // console.log(maskCreditCard('4336784463450309854738'));

      // Repeat
      const message2 = 'Bad weather... All Departures Delayed... @@';
      console.log(message2.repeat(3));

      const planesInLine = function (n) {
        console.log(`There are ${n} planes in line ${'✈️'.repeat(n)}`);
      };

      planesInLine(10);
      planesInLine(2);
      planesInLine(5);

      ///////////////////////////////////////
      // Coding Challenge #4

      /* 
      Write a program that receives a list of variable names written in underscore_case and convert them to camelCase.

      The input will come from a textarea inserted into the DOM (see code below), and conversion will happen when the button is pressed.

      THIS TEST DATA (pasted to textarea)
      underscore_case
      first_name
      Some_Variable 
      calculate_AGE
      delayed_departure

      SHOULD PRODUCE THIS OUTPUT (5 separate console.log outputs)
      underscoreCase      ✅
      firstName           ✅✅
      someVariable        ✅✅✅
      calculateAge        ✅✅✅✅
      delayedDeparture    ✅✅✅✅✅

      HINT 1: Remember which character defines a new line in the textarea 😉
      HINT 2: The solution only needs to work for a variable made out of 2 words, like a_b
      HINT 3: Start without worrying about the ✅. Tackle that only after you have the variable name conversion working 😉
      HINT 4: This challenge is difficult on purpose, so start watching the solution in case you're stuck. Then pause and continue!

      Afterwards, test with your own test data!

      GOOD LUCK 😀
      */
      // underscore_case?
      console.log(
        'Mine Challenge ================================================'
      );
      document.body.append(document.createElement('textarea'));
      document.body.append(document.createElement('button'));

      // 點擊時，抓到 textarea 輸入的值
      // const myBtn = document.querySelector('button');
      // myBtn.addEventListener('click', function () {
      //   const myTextArea = document
      //     .querySelector('textarea')
      //     .value.toLowerCase();
      //   // 再用 _ 分割字串成陣列
      //   const textArr = myTextArea.split('_');
      //   // 過濾掉索引大於等於 1 的元素
      //   const textArrFilter = textArr.filter(function (value, index) {
      //     return index < 1;
      //   });

      //   // 當陣列的索引值大於 0時，該字串的第一個字母就會是大寫
      //   textArr.forEach(function (text, i) {
      //     if (i > 0) {
      //       textArrFilter.push(text.replace(text[0], text[0].toUpperCase()));
      //     }
      //   });
      //   const result = textArrFilter.join('');
      //   console.log(result);
      // });

      console.log(
        'Teacher Challenge ================================================'
      );
      document.querySelector('button').addEventListener('click', function () {
        const text = document.querySelector('textarea').value;
        const rows = text.split('\n');
        for (const [i, row] of rows.entries()) {
          const [first, second] = row.toLowerCase().trim().split('_');
          const output = `${first}${second.replace(
            second[0],
            second[0].toUpperCase()
          )}`;

          // console.log(output.padEnd(20, ' '));
          // 如果是補充空格，也可以直接寫要補足的數量
          console.log(`${output.padEnd(20)}${'✅ '.repeat(i + 1)}`);
        }
      });

      // More exercise
      // Data needed for a later exercise
      const flights =
        '_Delayed_Departure;fao93766109;txl2133758440;11:25+_Arrival;bru0943384722;fao93766109;11:45+_Delayed_Arrival;hel7439299980;fao93766109;12:05+_Departure;fao93766109;lis2323639855;12:30';

      const getCode = str => str.slice(0, 3).toUpperCase();

      for (const flight of flights.split('+')) {
        const [status, from, to, time] = flight.split(';');
        const output = `${
          status.startsWith('_Delayed') ? '⛔️' : ''
        }${status.replaceAll('_', ' ')} ${getCode(from)} to ${getCode(
          to
        )} (${time.replace(':', 'h')})`;

        console.log(output.padStart(50));
      }
    </script>
  </body>
</html>
